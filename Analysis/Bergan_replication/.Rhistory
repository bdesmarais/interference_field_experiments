beta1s <- seq(from=-0.5, to=0.5, by=.25)
beta2s <- seq(from=-0.5, to=0.5, by=.25)
beta3s <- seq(from=-0.5, to=0.5, by=.25)
beta4s <- seq(from=-0.5, to=0.5, by=.25)
parameters <- expand.grid(beta1s,beta2s,beta3s,beta4s)
beta1s <- seq(from=-0.5, to=0.5, by=.5)
beta2s <- seq(from=-0.5, to=0.5, by=.5)
beta3s <- seq(from=-0.5, to=0.5, by=.5)
beta4s <- seq(from=-0.5, to=0.5, by=.5)
parameters <- expand.grid(beta1s,beta2s,beta3s,beta4s)
pvals <- numeric(nrow(parameters))
# Calculate observed test statistic
exposures <- indirect.treatment(permutation = z, adj.mat = S.ideo,expected.exp0.low,expected.exp1.low,expected.exp0.high,expected.exp1.high,low_support)
test.stat <- sum((lm(y.z ~ eval(z*low_support)+eval(z*(1-low_support)) + exposures[[3]]+exposures[[4]], na.action = na.omit)$resid)^2)
pval <- numeric(nrow(parameters))
for(i in 1:nrow(parameters)){
perm.y.0 <- z.to.unif(outcome=y.z, beta1=parameters[i,1], beta2=parameters[i,2], beta3=parameters[i,3], beta4=parameters[i,4], permutation=z, adj.mat=S.ideo,expected.exp0.low,expected.exp1.low,expected.exp0.high,expected.exp1.high,low_support)
#perm.y.0 <- z.to.unif(outcome = y.z, beta1 = beta1s[i], beta2 = beta2s[j], permutation = z, adj.mat = S.ideo)
# Calculate a vector of test statistic using permutations
beta1 <- parameters[i,1]
beta2 <- parameters[i,2]
beta3 <- parameters[i,3]
beta4 <- parameters[i,4]
perm.test.stats <- numeric(perms.test)
for(k in 1:perms.test){
#perm.z <- Z_block[,sample(1:10000, 1)]
perm.z <- perm[,sample(1:perms, 1)]
perm.exposure <- indirect.treatment(permutation = perm.z, adj.mat = S.ideo,expected.exp0.low,expected.exp1.low,expected.exp0.high,expected.exp1.high,low_support)
exposure_low <- perm.exposure[[3]]
exposure_high <- perm.exposure[[4]]
y.sim <- perm.y.0+beta1*perm.z*low_support + beta2*perm.z*(1-low_support) + beta3*exposure_low + beta4*exposure_high
perm.test.stats[k] <- sum((lm(y.sim ~ eval(perm.z*low_support)+eval(perm.z*(1-low_support))+exposure_low+exposure_high , na.action = na.omit)$resid)^2)
}
# Calculating p-value
pval[i] <- sum(perm.test.stats < test.stat)/perms.test
if(i/100==round(i/100)) save(list=c("pval","parameters"),file="CoppockSPPQRRresults.RData")
}
estimate <- c(parameters[which.max(pval),])
parameters <- as.matrix(parameters)
confidence.intervals <- NULL
for(i in 1:ncol(parameters)){
in.estimate=0
for(j in (1:ncol(parameters))[-i]){
in.estimate <- in.estimate+1*(parameters[,j]==estimate[j])
}
parameters.i <- parameters[in.estimate==(ncol(parameters)-1),]
pval.i <- pval[which(in.estimate==(ncol(parameters)-1))]
civals <- parameters.i[which(pval.i>0.05),i]
confidence.intervals <- rbind(confidence.intervals,c(min(civals),max(civals)))
}
for (i in 1:length(beta1s)){
pvals[i,] <- unlist(pvalues.ideology[i])
}
pvals #rows are direct effects, columns indirect
# Results
high.p.value <- max(pvals)
highest.p.indices <- which(pvals==max(pvals), arr.ind = TRUE)
direct.effect.PI <- beta1s[which(pvals==max(pvals), arr.ind = TRUE)[1]]
indirect.effect.PI <- beta2s[which(pvals==max(pvals), arr.ind = TRUE)[2]]
direct.effect.CI.high <- beta1s[max(which(pvals[,which(beta2s==indirect.effect.PI)] >= 0.05))]
direct.effect.CI.low <- beta1s[min(which(pvals[,which(beta2s==indirect.effect.PI)] >= 0.05))]
# read in results
load("CoppockSPPQRRresults_copartisan_committee_binary.RData")
setwd("~/git/interference_field_experiments/Analysis/coppock_replication_data/coppock_replication_data")
# read in results
load("CoppockSPPQRRresults_copartisan_committee_binary.RData")
copartisan_committee_binary_results <- do.call('rbind',BFP.results)[,1]
load("CoppockSPPQRRresults_copartisan_committee_weighted.RData")
copartisan_committee_weighted_results <- do.call('rbind',BFP.results)[,1]
load("CoppockSPPQRRresults_threshold60_unscaled.RData")
threshold60_unscaled_results <- do.call('rbind',BFP.results)[,1]
load("CoppockSPPQRRresults_threshold60_scaled.RData")
threshold60_scaled_results <- do.call('rbind',BFP.results)[,1]
load("CoppockSPPQRRresults_threshold80_scaled.RData")
threshold80_scaled_results <- do.call('rbind',BFP.results)[,1]
load("CoppockSPPQRRresults_threshold80_unscaled.RData")
threshold80_unscaled_results <- do.call('rbind',BFP.results)[,1]
load("CoppockSPPQRRresults_copartisan_cohort_binary.RData")
copartisan_cohort_binary_results <- do.call('rbind',BFP.results)[,1]
load("CoppockSPPQRRresults_copartisan_cohort_weighted.RData")
copartisan_cohort_weighted_results <- do.call('rbind',BFP.results)[,1]
BFP.results.summary <- function(parameters,p.values,level=0.95){
threshold <- 1-level
estimate <- as.numeric(parameters[which.max(p.values),])
CIs <- NULL
for(p in 1:ncol(parameters)){
select.col <- 0
for(c in (1:ncol(parameters))[-p]){
select.col <- select.col + 1*(parameters[,c]==estimate[c])
}
select.col <- which(select.col==(ncol(parameters)-1))
parameters.p <- parameters[select.col,p]
p.values.p <- p.values[select.col]
parameters.p <- parameters.p[which(p.values.p>threshold)]
CIs <- rbind(CIs,c(min(parameters.p),max(parameters.p)))
}
list(estimate,CIs)
}
summary.copartisan_committee_binary <- BFP.results.summary(parameters,copartisan_committee_binary_results)
summary.copartisan_committee_binary
summary.copartisan_committee_weighted <- BFP.results.summary(parameters,copartisan_committee_weighted_results)
summary.copartisan_committee_weighted
summary.copartisan_cohort_binary <- BFP.results.summary(parameters, copartisan_cohort_binary_results,level=0.9)
summary.copartisan_cohort_binary
summary.copartisan_cohort_binary <- BFP.results.summary(parameters, copartisan_cohort_binary_results)
summary.copartisan_cohort_binary
# read in results
load("BerganSPPQRRresults_copartisan_cohort_binary.RData")
setwd("~/git/interference_field_experiments/Analysis/Bergan_replication")
# read in results
load("BerganSPPQRRresults_copartisan_cohort_binary.RData")
copartisan_cohort_binary_results <- do.call('rbind',BFP.results)[,1]
load("BerganSPPQRRresults_copartisan_cohort_similarity.RData")
copartisan_cohort_weighted_results <- do.call('rbind',BFP.results)[,1]
load("BerganSPPQRRresults_cospon_binary_newmodel.RData")
copartisan_cosponsorship_binary_results <- do.call('rbind',BFP.results)[,1]
load("BerganSPPQRRresults_cospon_weighted_newmodel.RData")
copartisan_cosponsorship_weighted_results <- do.call('rbind',BFP.results)[,1]
BFP.results.summary <- function(parameters,p.values,level=0.95){
threshold <- 1-level
estimate <- as.numeric(parameters[which.max(p.values),])
CIs <- NULL
for(p in 1:ncol(parameters)){
select.col <- 0
for(c in (1:ncol(parameters))[-p]){
select.col <- select.col + 1*(parameters[,c]==estimate[c])
}
select.col <- which(select.col==(ncol(parameters)-1))
parameters.p <- parameters[select.col,p]
p.values.p <- p.values[select.col]
parameters.p <- parameters.p[which(p.values.p>threshold)]
CIs <- rbind(CIs,c(min(parameters.p),max(parameters.p)))
}
list(estimate,CIs)
}
summary.copartisan_cohort_binary <- BFP.results.summary(parameters,copartisan_cohort_binary_results)
summary.copartisan_cohort_binary
all_parameters <- NULL
cospon_binary_results <- NULL
rm(list=ls())
all_parameters <- NULL
cospon_binary_results <- NULL
load("BerganSPPQRRresults_cospon_binary1.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary2.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary3.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary4.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary5.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary6.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary7.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary8.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary9.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary10.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary11.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary12.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary13.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary14.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary15.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary16.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
parameters <- all_parameters
BFP.results.summary <- function(parameters,p.values,level=0.95){
threshold <- 1-level
estimate <- as.numeric(parameters[which.max(p.values),])
CIs <- NULL
for(p in 1:ncol(parameters)){
select.col <- 0
for(c in (1:ncol(parameters))[-p]){
select.col <- select.col + 1*(parameters[,c]==estimate[c])
}
select.col <- which(select.col==(ncol(parameters)-1))
parameters.p <- parameters[select.col,p]
p.values.p <- p.values[select.col]
parameters.p <- parameters.p[which(p.values.p>threshold)]
CIs <- rbind(CIs,c(min(parameters.p),max(parameters.p)))
}
list(estimate,CIs)
}
summary.cospon_binary <- BFP.results.summary(parameters,cospon_binary_results)
summary.cospon_binary.9 <- BFP.results.summary(parameters,cospon_binary_results,level=0.9)
library(xtable)
cospon.table <- cbind(summary.cospon_binary[[1]],summary.cospon_binary[[2]],summary.cospon_binary.9[[2]])
xtable(cospon.table)
rm(list=ls())
# read in results
load("BerganSPPQRRresults_copartisan_cohort_binary.RData")
copartisan_cohort_binary_results <- do.call('rbind',BFP.results)[,1]
load("BerganSPPQRRresults_copartisan_cohort_similarity.RData")
copartisan_cohort_weighted_results <- do.call('rbind',BFP.results)[,1]
load("BerganSPPQRRresults_cospon_binary_newmodel.RData")
copartisan_cosponsorship_binary_results <- do.call('rbind',BFP.results)[,1]
load("BerganSPPQRRresults_cospon_weighted_newmodel.RData")
copartisan_cosponsorship_weighted_results <- do.call('rbind',BFP.results)[,1]
BFP.results.summary <- function(parameters,p.values,level=0.95){
threshold <- 1-level
estimate <- as.numeric(parameters[which.max(p.values),])
CIs <- NULL
for(p in 1:ncol(parameters)){
select.col <- 0
for(c in (1:ncol(parameters))[-p]){
select.col <- select.col + 1*(parameters[,c]==estimate[c])
}
select.col <- which(select.col==(ncol(parameters)-1))
parameters.p <- parameters[select.col,p]
p.values.p <- p.values[select.col]
parameters.p <- parameters.p[which(p.values.p>threshold)]
CIs <- rbind(CIs,c(min(parameters.p),max(parameters.p)))
}
list(estimate,CIs)
}
summary.copartisan_cohort_binary <- BFP.results.summary(parameters,copartisan_cohort_binary_results)
summary.copartisan_cohort_binary
summary.copartisan_cohort_weighted <- BFP.results.summary(parameters,copartisan_cohort_weighted_results)
summary.copartisan_cohort_weighted
summary.copartisan_cospon_binary <- BFP.results.summary(parameters,copartisan_cosponsorship_binary_results)
summary.copartisan_cospon_binary
rm(list=ls())
all_parameters <- NULL
copartisan_cohort_binary_results <- NULL
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary1.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary2.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary3.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary4.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary5.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary6.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary7.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary8.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary9.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary10.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary11.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary12.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary13.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary14.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary15.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary16.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
parameters <- all_parameters
BFP.results.summary <- function(parameters,p.values,level=0.95){
threshold <- 1-level
estimate <- as.numeric(parameters[which.max(p.values),])
CIs <- NULL
for(p in 1:ncol(parameters)){
select.col <- 0
for(c in (1:ncol(parameters))[-p]){
select.col <- select.col + 1*(parameters[,c]==estimate[c])
}
select.col <- which(select.col==(ncol(parameters)-1))
parameters.p <- parameters[select.col,p]
p.values.p <- p.values[select.col]
parameters.p <- parameters.p[which(p.values.p>threshold)]
CIs <- rbind(CIs,c(min(parameters.p),max(parameters.p)))
}
list(estimate,CIs)
}
summary.copartisan_cohort_binary <- BFP.results.summary(parameters,copartisan_cohort_binary_results)
summary.copartisan_cohort_binary.9 <- BFP.results.summary(parameters,copartisan_cohort_binary_results,level=0.9)
library(xtable)
cohort.table <- cbind(summary.copartisan_cohort_binary[[1]],summary.copartisan_cohort_binary[[2]],summary.copartisan_cohort_binary.9[[2]])
xtable(cohort.table)
rm(list=ls())
all_parameters <- NULL
copartisan_cohort_weighted_results <- NULL
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity1.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity2.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity3.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity4.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity5.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity6.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity7.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity8.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity9.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity10.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity11.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity12.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity13.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity14.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity15.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity16.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
parameters <- all_parameters
BFP.results.summary <- function(parameters,p.values,level=0.95){
threshold <- 1-level
estimate <- as.numeric(parameters[which.max(p.values),])
CIs <- NULL
for(p in 1:ncol(parameters)){
select.col <- 0
for(c in (1:ncol(parameters))[-p]){
select.col <- select.col + 1*(parameters[,c]==estimate[c])
}
select.col <- which(select.col==(ncol(parameters)-1))
parameters.p <- parameters[select.col,p]
p.values.p <- p.values[select.col]
parameters.p <- parameters.p[which(p.values.p>threshold)]
CIs <- rbind(CIs,c(min(parameters.p),max(parameters.p)))
}
list(estimate,CIs)
}
summary.copartisan_cohort_weighted <- BFP.results.summary(parameters,copartisan_cohort_weighted_results)
summary.copartisan_cohort_weighted.9 <- BFP.results.summary(parameters,copartisan_cohort_weighted_results,level=0.9)
library(xtable)
cohort.table <- cbind(summary.copartisan_cohort_weighted[[1]],summary.copartisan_cohort_weighted[[2]],summary.copartisan_cohort_weighted.9[[2]])
xtable(cohort.table)
rm(list=ls())
all_parameters <- NULL
cospon_binary_results <- NULL
load("BerganSPPQRRresults_cospon_binary1.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary2.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary3.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary4.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary5.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary6.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary7.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary8.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary9.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary10.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary11.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary12.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary13.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary14.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary15.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary16.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
parameters <- all_parameters
BFP.results.summary <- function(parameters,p.values,level=0.95){
threshold <- 1-level
estimate <- as.numeric(parameters[which.max(p.values),])
CIs <- NULL
for(p in 1:ncol(parameters)){
select.col <- 0
for(c in (1:ncol(parameters))[-p]){
select.col <- select.col + 1*(parameters[,c]==estimate[c])
}
select.col <- which(select.col==(ncol(parameters)-1))
parameters.p <- parameters[select.col,p]
p.values.p <- p.values[select.col]
parameters.p <- parameters.p[which(p.values.p>threshold)]
CIs <- rbind(CIs,c(min(parameters.p),max(parameters.p)))
}
list(estimate,CIs)
}
summary.cospon_binary <- BFP.results.summary(parameters,cospon_binary_results)
summary.cospon_binary.9 <- BFP.results.summary(parameters,cospon_binary_results,level=0.9)
library(xtable)
cospon.table <- cbind(summary.cospon_binary[[1]],summary.cospon_binary[[2]],summary.cospon_binary.9[[2]])
xtable(cospon.table)
rm(list=ls())
# read in results
load("BerganSPPQRRresults_copartisan_cohort_binary.RData")
rm(list=ls())
load("BerganSPPQRRresults_cospon_weighted_newmodel.RData")
copartisan_cosponsorship_weighted_results <- do.call('rbind',BFP.results)[,1]
BFP.results.summary <- function(parameters,p.values,level=0.95){
threshold <- 1-level
estimate <- as.numeric(parameters[which.max(p.values),])
CIs <- NULL
for(p in 1:ncol(parameters)){
select.col <- 0
for(c in (1:ncol(parameters))[-p]){
select.col <- select.col + 1*(parameters[,c]==estimate[c])
}
select.col <- which(select.col==(ncol(parameters)-1))
parameters.p <- parameters[select.col,p]
p.values.p <- p.values[select.col]
parameters.p <- parameters.p[which(p.values.p>threshold)]
CIs <- rbind(CIs,c(min(parameters.p),max(parameters.p)))
}
list(estimate,CIs)
}
summary.copartisan_cospon_weighted <- BFP.results.summary(parameters,copartisan_cosponsorship_weighted_results)
summary.copartisan_cospon_weighted
BFP.results.summary <- function(parameters,p.values,level=0.9){
threshold <- 1-level
estimate <- as.numeric(parameters[which.max(p.values),])
CIs <- NULL
for(p in 1:ncol(parameters)){
select.col <- 0
for(c in (1:ncol(parameters))[-p]){
select.col <- select.col + 1*(parameters[,c]==estimate[c])
}
select.col <- which(select.col==(ncol(parameters)-1))
parameters.p <- parameters[select.col,p]
p.values.p <- p.values[select.col]
parameters.p <- parameters.p[which(p.values.p>threshold)]
CIs <- rbind(CIs,c(min(parameters.p),max(parameters.p)))
}
list(estimate,CIs)
}
summary.copartisan_cospon_weighted <- BFP.results.summary(parameters,copartisan_cosponsorship_weighted_results)
summary.copartisan_cospon_weighted
