}
# Calculating p-value
pval[i] <- sum(perm.test.stats < test.stat)/perms.test
if(i/100==round(i/100)) save(list=c("pval","parameters"),file="CoppockSPPQRRresults.RData")
}
estimate <- c(parameters[which.max(pval),])
parameters <- as.matrix(parameters)
confidence.intervals <- NULL
for(i in 1:ncol(parameters)){
in.estimate=0
for(j in (1:ncol(parameters))[-i]){
in.estimate <- in.estimate+1*(parameters[,j]==estimate[j])
}
parameters.i <- parameters[in.estimate==(ncol(parameters)-1),]
pval.i <- pval[which(in.estimate==(ncol(parameters)-1))]
civals <- parameters.i[which(pval.i>0.05),i]
confidence.intervals <- rbind(confidence.intervals,c(min(civals),max(civals)))
}
for (i in 1:length(beta1s)){
pvals[i,] <- unlist(pvalues.ideology[i])
}
pvals #rows are direct effects, columns indirect
# Results
high.p.value <- max(pvals)
highest.p.indices <- which(pvals==max(pvals), arr.ind = TRUE)
direct.effect.PI <- beta1s[which(pvals==max(pvals), arr.ind = TRUE)[1]]
indirect.effect.PI <- beta2s[which(pvals==max(pvals), arr.ind = TRUE)[2]]
direct.effect.CI.high <- beta1s[max(which(pvals[,which(beta2s==indirect.effect.PI)] >= 0.05))]
direct.effect.CI.low <- beta1s[min(which(pvals[,which(beta2s==indirect.effect.PI)] >= 0.05))]
# read in results
load("CoppockSPPQRRresults_copartisan_committee_binary.RData")
setwd("~/git/interference_field_experiments/Analysis/coppock_replication_data/coppock_replication_data")
# read in results
load("CoppockSPPQRRresults_copartisan_committee_binary.RData")
copartisan_committee_binary_results <- do.call('rbind',BFP.results)[,1]
load("CoppockSPPQRRresults_copartisan_committee_weighted.RData")
copartisan_committee_weighted_results <- do.call('rbind',BFP.results)[,1]
load("CoppockSPPQRRresults_threshold60_unscaled.RData")
threshold60_unscaled_results <- do.call('rbind',BFP.results)[,1]
load("CoppockSPPQRRresults_threshold60_scaled.RData")
threshold60_scaled_results <- do.call('rbind',BFP.results)[,1]
load("CoppockSPPQRRresults_threshold80_scaled.RData")
threshold80_scaled_results <- do.call('rbind',BFP.results)[,1]
load("CoppockSPPQRRresults_threshold80_unscaled.RData")
threshold80_unscaled_results <- do.call('rbind',BFP.results)[,1]
load("CoppockSPPQRRresults_copartisan_cohort_binary.RData")
copartisan_cohort_binary_results <- do.call('rbind',BFP.results)[,1]
load("CoppockSPPQRRresults_copartisan_cohort_weighted.RData")
copartisan_cohort_weighted_results <- do.call('rbind',BFP.results)[,1]
BFP.results.summary <- function(parameters,p.values,level=0.95){
threshold <- 1-level
estimate <- as.numeric(parameters[which.max(p.values),])
CIs <- NULL
for(p in 1:ncol(parameters)){
select.col <- 0
for(c in (1:ncol(parameters))[-p]){
select.col <- select.col + 1*(parameters[,c]==estimate[c])
}
select.col <- which(select.col==(ncol(parameters)-1))
parameters.p <- parameters[select.col,p]
p.values.p <- p.values[select.col]
parameters.p <- parameters.p[which(p.values.p>threshold)]
CIs <- rbind(CIs,c(min(parameters.p),max(parameters.p)))
}
list(estimate,CIs)
}
summary.copartisan_committee_binary <- BFP.results.summary(parameters,copartisan_committee_binary_results)
summary.copartisan_committee_binary
summary.copartisan_committee_weighted <- BFP.results.summary(parameters,copartisan_committee_weighted_results)
summary.copartisan_committee_weighted
summary.copartisan_cohort_binary <- BFP.results.summary(parameters, copartisan_cohort_binary_results,level=0.9)
summary.copartisan_cohort_binary
summary.copartisan_cohort_binary <- BFP.results.summary(parameters, copartisan_cohort_binary_results)
summary.copartisan_cohort_binary
# read in results
load("BerganSPPQRRresults_copartisan_cohort_binary.RData")
setwd("~/git/interference_field_experiments/Analysis/Bergan_replication")
# read in results
load("BerganSPPQRRresults_copartisan_cohort_binary.RData")
copartisan_cohort_binary_results <- do.call('rbind',BFP.results)[,1]
load("BerganSPPQRRresults_copartisan_cohort_similarity.RData")
copartisan_cohort_weighted_results <- do.call('rbind',BFP.results)[,1]
load("BerganSPPQRRresults_cospon_binary_newmodel.RData")
copartisan_cosponsorship_binary_results <- do.call('rbind',BFP.results)[,1]
load("BerganSPPQRRresults_cospon_weighted_newmodel.RData")
copartisan_cosponsorship_weighted_results <- do.call('rbind',BFP.results)[,1]
BFP.results.summary <- function(parameters,p.values,level=0.95){
threshold <- 1-level
estimate <- as.numeric(parameters[which.max(p.values),])
CIs <- NULL
for(p in 1:ncol(parameters)){
select.col <- 0
for(c in (1:ncol(parameters))[-p]){
select.col <- select.col + 1*(parameters[,c]==estimate[c])
}
select.col <- which(select.col==(ncol(parameters)-1))
parameters.p <- parameters[select.col,p]
p.values.p <- p.values[select.col]
parameters.p <- parameters.p[which(p.values.p>threshold)]
CIs <- rbind(CIs,c(min(parameters.p),max(parameters.p)))
}
list(estimate,CIs)
}
summary.copartisan_cohort_binary <- BFP.results.summary(parameters,copartisan_cohort_binary_results)
summary.copartisan_cohort_binary
all_parameters <- NULL
cospon_binary_results <- NULL
rm(list=ls())
all_parameters <- NULL
cospon_binary_results <- NULL
load("BerganSPPQRRresults_cospon_binary1.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary2.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary3.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary4.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary5.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary6.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary7.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary8.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary9.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary10.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary11.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary12.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary13.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary14.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary15.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary16.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
parameters <- all_parameters
BFP.results.summary <- function(parameters,p.values,level=0.95){
threshold <- 1-level
estimate <- as.numeric(parameters[which.max(p.values),])
CIs <- NULL
for(p in 1:ncol(parameters)){
select.col <- 0
for(c in (1:ncol(parameters))[-p]){
select.col <- select.col + 1*(parameters[,c]==estimate[c])
}
select.col <- which(select.col==(ncol(parameters)-1))
parameters.p <- parameters[select.col,p]
p.values.p <- p.values[select.col]
parameters.p <- parameters.p[which(p.values.p>threshold)]
CIs <- rbind(CIs,c(min(parameters.p),max(parameters.p)))
}
list(estimate,CIs)
}
summary.cospon_binary <- BFP.results.summary(parameters,cospon_binary_results)
summary.cospon_binary.9 <- BFP.results.summary(parameters,cospon_binary_results,level=0.9)
library(xtable)
cospon.table <- cbind(summary.cospon_binary[[1]],summary.cospon_binary[[2]],summary.cospon_binary.9[[2]])
xtable(cospon.table)
rm(list=ls())
# read in results
load("BerganSPPQRRresults_copartisan_cohort_binary.RData")
copartisan_cohort_binary_results <- do.call('rbind',BFP.results)[,1]
load("BerganSPPQRRresults_copartisan_cohort_similarity.RData")
copartisan_cohort_weighted_results <- do.call('rbind',BFP.results)[,1]
load("BerganSPPQRRresults_cospon_binary_newmodel.RData")
copartisan_cosponsorship_binary_results <- do.call('rbind',BFP.results)[,1]
load("BerganSPPQRRresults_cospon_weighted_newmodel.RData")
copartisan_cosponsorship_weighted_results <- do.call('rbind',BFP.results)[,1]
BFP.results.summary <- function(parameters,p.values,level=0.95){
threshold <- 1-level
estimate <- as.numeric(parameters[which.max(p.values),])
CIs <- NULL
for(p in 1:ncol(parameters)){
select.col <- 0
for(c in (1:ncol(parameters))[-p]){
select.col <- select.col + 1*(parameters[,c]==estimate[c])
}
select.col <- which(select.col==(ncol(parameters)-1))
parameters.p <- parameters[select.col,p]
p.values.p <- p.values[select.col]
parameters.p <- parameters.p[which(p.values.p>threshold)]
CIs <- rbind(CIs,c(min(parameters.p),max(parameters.p)))
}
list(estimate,CIs)
}
summary.copartisan_cohort_binary <- BFP.results.summary(parameters,copartisan_cohort_binary_results)
summary.copartisan_cohort_binary
summary.copartisan_cohort_weighted <- BFP.results.summary(parameters,copartisan_cohort_weighted_results)
summary.copartisan_cohort_weighted
summary.copartisan_cospon_binary <- BFP.results.summary(parameters,copartisan_cosponsorship_binary_results)
summary.copartisan_cospon_binary
rm(list=ls())
all_parameters <- NULL
copartisan_cohort_binary_results <- NULL
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary1.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary2.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary3.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary4.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary5.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary6.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary7.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary8.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary9.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary10.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary11.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary12.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary13.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary14.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary15.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_binary16.RData")
copartisan_cohort_binary_results <- c(copartisan_cohort_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
parameters <- all_parameters
BFP.results.summary <- function(parameters,p.values,level=0.95){
threshold <- 1-level
estimate <- as.numeric(parameters[which.max(p.values),])
CIs <- NULL
for(p in 1:ncol(parameters)){
select.col <- 0
for(c in (1:ncol(parameters))[-p]){
select.col <- select.col + 1*(parameters[,c]==estimate[c])
}
select.col <- which(select.col==(ncol(parameters)-1))
parameters.p <- parameters[select.col,p]
p.values.p <- p.values[select.col]
parameters.p <- parameters.p[which(p.values.p>threshold)]
CIs <- rbind(CIs,c(min(parameters.p),max(parameters.p)))
}
list(estimate,CIs)
}
summary.copartisan_cohort_binary <- BFP.results.summary(parameters,copartisan_cohort_binary_results)
summary.copartisan_cohort_binary.9 <- BFP.results.summary(parameters,copartisan_cohort_binary_results,level=0.9)
library(xtable)
cohort.table <- cbind(summary.copartisan_cohort_binary[[1]],summary.copartisan_cohort_binary[[2]],summary.copartisan_cohort_binary.9[[2]])
xtable(cohort.table)
rm(list=ls())
all_parameters <- NULL
copartisan_cohort_weighted_results <- NULL
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity1.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity2.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity3.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity4.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity5.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity6.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity7.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity8.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity9.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity10.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity11.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity12.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity13.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity14.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity15.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_copartisan_cohort_chamber_similarity16.RData")
copartisan_cohort_weighted_results <- c(copartisan_cohort_weighted_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
parameters <- all_parameters
BFP.results.summary <- function(parameters,p.values,level=0.95){
threshold <- 1-level
estimate <- as.numeric(parameters[which.max(p.values),])
CIs <- NULL
for(p in 1:ncol(parameters)){
select.col <- 0
for(c in (1:ncol(parameters))[-p]){
select.col <- select.col + 1*(parameters[,c]==estimate[c])
}
select.col <- which(select.col==(ncol(parameters)-1))
parameters.p <- parameters[select.col,p]
p.values.p <- p.values[select.col]
parameters.p <- parameters.p[which(p.values.p>threshold)]
CIs <- rbind(CIs,c(min(parameters.p),max(parameters.p)))
}
list(estimate,CIs)
}
summary.copartisan_cohort_weighted <- BFP.results.summary(parameters,copartisan_cohort_weighted_results)
summary.copartisan_cohort_weighted.9 <- BFP.results.summary(parameters,copartisan_cohort_weighted_results,level=0.9)
library(xtable)
cohort.table <- cbind(summary.copartisan_cohort_weighted[[1]],summary.copartisan_cohort_weighted[[2]],summary.copartisan_cohort_weighted.9[[2]])
xtable(cohort.table)
rm(list=ls())
all_parameters <- NULL
cospon_binary_results <- NULL
load("BerganSPPQRRresults_cospon_binary1.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary2.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary3.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary4.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary5.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary6.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary7.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary8.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary9.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary10.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary11.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary12.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary13.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary14.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary15.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
load("BerganSPPQRRresults_cospon_binary16.RData")
cospon_binary_results <- c(cospon_binary_results,do.call('rbind',BFP.results)[,1])
all_parameters <- rbind(all_parameters,parameters)
parameters <- all_parameters
BFP.results.summary <- function(parameters,p.values,level=0.95){
threshold <- 1-level
estimate <- as.numeric(parameters[which.max(p.values),])
CIs <- NULL
for(p in 1:ncol(parameters)){
select.col <- 0
for(c in (1:ncol(parameters))[-p]){
select.col <- select.col + 1*(parameters[,c]==estimate[c])
}
select.col <- which(select.col==(ncol(parameters)-1))
parameters.p <- parameters[select.col,p]
p.values.p <- p.values[select.col]
parameters.p <- parameters.p[which(p.values.p>threshold)]
CIs <- rbind(CIs,c(min(parameters.p),max(parameters.p)))
}
list(estimate,CIs)
}
summary.cospon_binary <- BFP.results.summary(parameters,cospon_binary_results)
summary.cospon_binary.9 <- BFP.results.summary(parameters,cospon_binary_results,level=0.9)
library(xtable)
cospon.table <- cbind(summary.cospon_binary[[1]],summary.cospon_binary[[2]],summary.cospon_binary.9[[2]])
xtable(cospon.table)
rm(list=ls())
# read in results
load("BerganSPPQRRresults_copartisan_cohort_binary.RData")
rm(list=ls())
load("BerganSPPQRRresults_cospon_weighted_newmodel.RData")
copartisan_cosponsorship_weighted_results <- do.call('rbind',BFP.results)[,1]
BFP.results.summary <- function(parameters,p.values,level=0.95){
threshold <- 1-level
estimate <- as.numeric(parameters[which.max(p.values),])
CIs <- NULL
for(p in 1:ncol(parameters)){
select.col <- 0
for(c in (1:ncol(parameters))[-p]){
select.col <- select.col + 1*(parameters[,c]==estimate[c])
}
select.col <- which(select.col==(ncol(parameters)-1))
parameters.p <- parameters[select.col,p]
p.values.p <- p.values[select.col]
parameters.p <- parameters.p[which(p.values.p>threshold)]
CIs <- rbind(CIs,c(min(parameters.p),max(parameters.p)))
}
list(estimate,CIs)
}
summary.copartisan_cospon_weighted <- BFP.results.summary(parameters,copartisan_cosponsorship_weighted_results)
summary.copartisan_cospon_weighted
BFP.results.summary <- function(parameters,p.values,level=0.9){
threshold <- 1-level
estimate <- as.numeric(parameters[which.max(p.values),])
CIs <- NULL
for(p in 1:ncol(parameters)){
select.col <- 0
for(c in (1:ncol(parameters))[-p]){
select.col <- select.col + 1*(parameters[,c]==estimate[c])
}
select.col <- which(select.col==(ncol(parameters)-1))
parameters.p <- parameters[select.col,p]
p.values.p <- p.values[select.col]
parameters.p <- parameters.p[which(p.values.p>threshold)]
CIs <- rbind(CIs,c(min(parameters.p),max(parameters.p)))
}
list(estimate,CIs)
}
summary.copartisan_cospon_weighted <- BFP.results.summary(parameters,copartisan_cosponsorship_weighted_results)
summary.copartisan_cospon_weighted
# read in results
load("BerganSPPQRRresults_copartisan_cohort_binary.RData")
copartisan_cohort_binary_results <- do.call('rbind',BFP.results)[,1]
load("BerganSPPQRRresults_copartisan_cohort_similarity.RData")
copartisan_cohort_weighted_results <- do.call('rbind',BFP.results)[,1]
load("BerganSPPQRRresults_cospon_binary_newmodel.RData")
copartisan_cosponsorship_binary_results <- do.call('rbind',BFP.results)[,1]
load("BerganSPPQRRresults_cospon_weighted_newmodel.RData")
copartisan_cosponsorship_weighted_results <- do.call('rbind',BFP.results)[,1]
BFP.results.summary <- function(parameters,p.values,level=0.95){
threshold <- 1-level
estimate <- as.numeric(parameters[which.max(p.values),])
CIs <- NULL
for(p in 1:ncol(parameters)){
select.col <- 0
for(c in (1:ncol(parameters))[-p]){
select.col <- select.col + 1*(parameters[,c]==estimate[c])
}
select.col <- which(select.col==(ncol(parameters)-1))
parameters.p <- parameters[select.col,p]
p.values.p <- p.values[select.col]
parameters.p <- parameters.p[which(p.values.p>threshold)]
CIs <- rbind(CIs,c(min(parameters.p),max(parameters.p)))
}
list(estimate,CIs)
}
summary.copartisan_cohort_binary <- BFP.results.summary(parameters,copartisan_cohort_binary_results)
summary.copartisan_cohort_weighted <- BFP.results.summary(parameters,copartisan_cohort_weighted_results)
summary.copartisan_cospon_binary <- BFP.results.summary(parameters,copartisan_cosponsorship_binary_results)
summary.copartisan_cospon_weighted <- BFP.results.summary(parameters,copartisan_cosponsorship_weighted_results)
summary.copartisan_cospon_weighted
summary.copartisan_cospon_binary
